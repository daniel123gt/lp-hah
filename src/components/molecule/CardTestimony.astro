---
import Avatar from "../atom/Avatar.astro";
const { name, rol, audio, avatar, loading = "lazy" } = Astro.props;
---

<article
  class="w-[324px] h-full rounded-xl overflow-hidden shadow bg-white p-4"
>
  <div class="flex gap-2 items-center">
    <Avatar label={avatar} />
    <div>
      <p class="text-lg text-text-medium font-semibold">{name}</p>
      <p class="text-md text-text-medium/70 font-normal">{rol}</p>
    </div>
  </div>
  <figure class="pt-4">
    <audio 
      controls 
      src={audio} 
      preload="none" 
      class="w-full"
      data-loading={loading}
    >
      Tu navegador no soporta el elemento de audio.
    </audio>
  </figure>
</article>

<script>
  // Lazy loading para audio
  const audioElements = document.querySelectorAll('audio[data-loading="lazy"]');
  
  const audioObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const audio = entry.target as HTMLAudioElement;
        audio.preload = "metadata";
        audioObserver.unobserve(audio);
      }
    });
  });
  
  audioElements.forEach(audio => audioObserver.observe(audio));
</script>

<style>
  /* Estilo personalizado para el audio player */
  audio {
    height: 40px;
    border-radius: 8px;
  }
</style>
